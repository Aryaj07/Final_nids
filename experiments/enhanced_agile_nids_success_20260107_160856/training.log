2026-01-07 16:08:56,245 - SuccessAgileNIDSTrainer - INFO - Starting Success AGILE NIDS training - Experiment: enhanced_agile_nids_success
2026-01-07 16:08:56,245 - SuccessAgileNIDSTrainer - INFO - Autoencoder device: privateuseone:0
2026-01-07 16:08:56,245 - SuccessAgileNIDSTrainer - INFO - TAGN device: cpu
2026-01-07 16:08:56,245 - SuccessAgileNIDSTrainer - INFO - Configuration: {
  "autoencoder_epochs": 15,
  "autoencoder_lr": 0.001,
  "autoencoder_batch_size": 256,
  "autoencoder_weight_decay": 1e-05,
  "tagn_epochs": 50,
  "tagn_lr": 0.0005,
  "tagn_batch_size": 128,
  "tagn_weight_decay": 0.001,
  "tagn_sequence_length": 25,
  "tagn_validation_split": 0.2,
  "tagn_early_stopping_patience": 7,
  "correlation_epochs": 15,
  "correlation_lr": 0.0001,
  "correlation_batch_size": 64,
  "train_files": [
    "GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv",
    "GeneratedLabelledFlows/TrafficLabelling/Thursday-WorkingHours-Morning-WebAttacks.pcap_ISCX.csv",
    "GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv",
    "GeneratedLabelledFlows/TrafficLabelling/Monday-WorkingHours.pcap_ISCX.csv",
    "GeneratedLabelledFlows/TrafficLabelling/Tuesday-WorkingHours.pcap_ISCX.csv",
    "GeneratedLabelledFlows/TrafficLabelling/Wednesday-workingHours.pcap_ISCX.csv"
  ],
  "test_files": [
    "GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Morning.pcap_ISCX.csv"
  ],
  "max_rows_per_file": null,
  "enable_memory_cleanup": true
}
2026-01-07 16:08:56,246 - SuccessAgileNIDSTrainer - INFO - Loading and preparing training data...
2026-01-07 16:08:57,716 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv: (225745, 85)
2026-01-07 16:08:59,429 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Thursday-WorkingHours-Morning-WebAttacks.pcap_ISCX.csv: (458968, 85)
2026-01-07 16:09:01,066 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv: (286467, 85)
2026-01-07 16:09:05,343 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Monday-WorkingHours.pcap_ISCX.csv: (529918, 85)
2026-01-07 16:09:08,399 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Tuesday-WorkingHours.pcap_ISCX.csv: (445909, 85)
2026-01-07 16:09:13,404 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Wednesday-workingHours.pcap_ISCX.csv: (692703, 85)
2026-01-07 16:09:14,720 - SuccessAgileNIDSTrainer - INFO - Loaded GeneratedLabelledFlows/TrafficLabelling/Friday-WorkingHours-Morning.pcap_ISCX.csv: (191033, 85)
2026-01-07 16:09:15,130 - SuccessAgileNIDSTrainer - INFO - Combined training data: (2639710, 85)
2026-01-07 16:09:19,322 - SuccessAgileNIDSTrainer - INFO - Input dimension: 80
2026-01-07 16:09:19,331 - EnhancedAgileNIDS - INFO - [SUCCESS] All components initialized successfully
2026-01-07 16:09:20,702 - SuccessAgileNIDSTrainer - INFO - Data: 1795464 benign, 844246 attack samples
2026-01-07 16:09:25,384 - SuccessAgileNIDSTrainer - INFO - Data preparation complete: (1794006, 80)
2026-01-07 16:09:25,385 - SuccessAgileNIDSTrainer - INFO - Scaler saved to experiments/enhanced_agile_nids_success_20260107_160856\scaler.pkl
2026-01-07 16:09:25,688 - SuccessAgileNIDSTrainer - INFO - Training Autoencoder (Stream A)...
2026-01-07 16:11:45,147 - SuccessAgileNIDSTrainer - INFO -   Autoencoder Epoch 3/15 - Loss: 0.045441, Time: 138.8s
2026-01-07 16:13:43,033 - SuccessAgileNIDSTrainer - INFO -   Autoencoder Epoch 6/15 - Loss: 0.030104, Time: 256.7s
2026-01-07 16:15:36,649 - SuccessAgileNIDSTrainer - INFO -   Autoencoder Epoch 9/15 - Loss: 0.020976, Time: 370.3s
2026-01-07 16:17:37,775 - SuccessAgileNIDSTrainer - INFO -   Autoencoder Epoch 12/15 - Loss: 0.018682, Time: 491.4s
2026-01-07 16:19:31,906 - SuccessAgileNIDSTrainer - INFO -   Autoencoder Epoch 15/15 - Loss: 0.016606, Time: 605.6s
2026-01-07 16:19:31,915 - SuccessAgileNIDSTrainer - INFO - Autoencoder saved to experiments/enhanced_agile_nids_success_20260107_160856\autoencoder_trained.pt
2026-01-07 16:19:31,986 - SuccessAgileNIDSTrainer - INFO - Training TAGN Network (Stream B)...
2026-01-07 16:19:31,986 - SuccessAgileNIDSTrainer - INFO - Processing benign traffic...
2026-01-07 16:19:37,479 - SuccessAgileNIDSTrainer - INFO - Created 71760 benign sequences
2026-01-07 16:19:37,479 - SuccessAgileNIDSTrainer - INFO - Processing attack traffic...
2026-01-07 16:19:39,752 - SuccessAgileNIDSTrainer - INFO - Created 22182 attack sequences
2026-01-07 16:19:39,909 - SuccessAgileNIDSTrainer - INFO - TAGN training data: torch.Size([93942, 25, 80])
2026-01-07 16:19:39,993 - SuccessAgileNIDSTrainer - INFO - Train: 75153 sequences, Val: 18789 sequences
2026-01-07 16:19:40,004 - SuccessAgileNIDSTrainer - INFO - Train class distribution: tensor([57408, 17745])
2026-01-07 16:19:40,005 - SuccessAgileNIDSTrainer - INFO - Val class distribution: tensor([14352,  4437])
2026-01-07 16:20:03,059 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 93.36%)
2026-01-07 16:20:26,770 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 98.15%)
2026-01-07 16:20:50,810 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.60%)
2026-01-07 16:21:14,074 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.94%)
2026-01-07 16:21:37,152 - SuccessAgileNIDSTrainer - INFO -   TAGN Epoch 5/50 - Loss: 0.0008, Train Acc: 99.99%, Val Loss: 0.0053, Val Acc: 99.76%, Time: 117.1s
2026-01-07 16:22:01,988 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.96%)
2026-01-07 16:22:28,789 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.97%)
2026-01-07 16:22:55,520 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.97%)
2026-01-07 16:23:22,330 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 99.99%)
2026-01-07 16:23:49,013 - SuccessAgileNIDSTrainer - INFO -   [BEST] New best model saved (Val Acc: 100.00%)
2026-01-07 16:23:49,014 - SuccessAgileNIDSTrainer - INFO -   TAGN Epoch 10/50 - Loss: 0.0005, Train Acc: 99.99%, Val Loss: 0.0000, Val Acc: 100.00%, Time: 249.0s
2026-01-07 16:26:02,668 - SuccessAgileNIDSTrainer - INFO -   TAGN Epoch 15/50 - Loss: 0.0004, Train Acc: 99.99%, Val Loss: 0.0000, Val Acc: 100.00%, Time: 382.7s
2026-01-07 16:26:56,146 - SuccessAgileNIDSTrainer - INFO -   Early stopping triggered after 17 epochs (no improvement for 7 epochs)
2026-01-07 16:26:56,163 - SuccessAgileNIDSTrainer - INFO - TAGN training complete (Best Val Acc: 100.00%)
2026-01-07 16:26:56,322 - SuccessAgileNIDSTrainer - INFO - Training Correlation Engine (REAL DATA)
2026-01-07 16:27:17,602 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 1/10 - Loss: 0.6445
2026-01-07 16:27:30,925 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 2/10 - Loss: 0.6049
2026-01-07 16:27:44,243 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 3/10 - Loss: 0.6042
2026-01-07 16:27:57,644 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 4/10 - Loss: 0.6039
2026-01-07 16:28:10,939 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 5/10 - Loss: 0.6038
2026-01-07 16:28:24,225 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 6/10 - Loss: 0.6037
2026-01-07 16:28:37,573 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 7/10 - Loss: 0.6037
2026-01-07 16:28:51,496 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 8/10 - Loss: 0.6037
2026-01-07 16:29:04,853 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 9/10 - Loss: 0.6036
2026-01-07 16:29:18,137 - SuccessAgileNIDSTrainer - INFO - Correlation Epoch 10/10 - Loss: 0.6036
2026-01-07 16:29:18,140 - SuccessAgileNIDSTrainer - INFO - Correlation engine saved to experiments/enhanced_agile_nids_success_20260107_160856\correlation_engine.pt
2026-01-07 16:29:18,184 - SuccessAgileNIDSTrainer - INFO - Calibrating decision threshold...
2026-01-07 16:30:15,735 - SuccessAgileNIDSTrainer - INFO - Calibrated threshold = 0.541430 (95th percentile)
2026-01-07 16:30:15,736 - SuccessAgileNIDSTrainer - INFO - Creating dual-stream models...
2026-01-07 16:30:15,739 - EnhancedAgileNIDS - INFO - [SUCCESS] Autoencoder loaded from experiments/enhanced_agile_nids_success_20260107_160856\autoencoder_trained.pt
2026-01-07 16:30:15,740 - EnhancedAgileNIDS - INFO - [SUCCESS] TAGN network loaded from experiments/enhanced_agile_nids_success_20260107_160856\tagn_best.pt
2026-01-07 16:30:15,742 - EnhancedAgileNIDS - INFO - [SUCCESS] Correlation engine loaded from experiments/enhanced_agile_nids_success_20260107_160856\correlation_engine.pt
2026-01-07 16:30:15,742 - EnhancedAgileNIDS - INFO - [SUCCESS] All models loaded successfully
2026-01-07 16:30:15,951 - EnhancedAgileNIDS - ERROR - [ERROR] Error exporting TorchScript models: Tracer cannot infer type of {'classification': {'logits': tensor([[ 4.1215, -4.3217]], grad_fn=<AddmmBackward0>), 'class_probabilities': tensor([[9.9978e-01, 2.1532e-04]], grad_fn=<SoftmaxBackward0>), 'predicted_class': tensor([0]), 'confidence_score': tensor([0.9998], grad_fn=<MaxBackward0>)}, 'correlation_features': tensor([[ 0.0184,  0.0609,  0.0513,  0.0621, -0.0315, -0.0257, -0.1091,  0.0015,
          0.1490, -0.0511,  0.0203,  0.0865, -0.0442,  0.0673,  0.1027, -0.0130]],
       grad_fn=<AddmmBackward0>), 'sequence_features': tensor([[-1.3136e-02, -9.9869e-02, -5.6877e-02,  1.0207e-01,  7.8456e-02,
          5.2883e-02, -9.7871e-02,  4.2044e-02,  7.3395e-02,  3.9242e-02,
         -1.3691e-01, -8.2964e-02,  1.9357e-01,  6.2814e-03, -7.4487e-02,
          2.4307e-03, -4.0376e-02, -1.0636e-01, -1.4352e-01,  6.8257e-02,
         -6.1108e-02, -3.7508e-02, -5.7355e-02,  3.8769e-03,  5.0960e-02,
          6.0605e-03,  1.2793e-01,  3.8654e-02,  4.1289e-02,  5.6944e-02,
         -1.2598e-01,  2.7501e-02, -9.5815e-03, -1.1813e-01,  5.2921e-02,
          7.4631e-02,  8.2432e-02, -4.5100e-02, -4.3007e-03, -7.5712e-02,
         -7.0332e-02, -5.3736e-02,  1.4160e-01, -3.8618e-02,  9.8625e-02,
          8.2418e-02, -5.3224e-02, -3.7407e-02, -5.3675e-02,  1.2179e-01,
         -6.6500e-02, -4.5622e-02,  2.2493e-02, -3.1636e-02, -1.0890e-01,
         -4.5304e-03,  4.1965e-02,  6.9031e-02,  1.6025e-01,  9.3641e-02,
          2.1865e-04, -6.8276e-02,  5.4737e-02, -1.4577e-02, -3.3168e-02,
          2.3539e-03, -8.7058e-02, -1.1617e-01,  2.3056e-01, -3.0071e-02,
         -1.4368e-03, -7.1228e-02,  4.6677e-02,  5.8323e-03, -1.2176e-01,
          9.6400e-02,  1.5997e-01,  1.9590e-02, -5.3614e-02, -1.0719e-01,
         -7.9765e-02, -8.4837e-02, -8.9610e-02, -1.8800e-01,  2.2734e-02,
         -3.0915e-02,  1.5180e-01,  1.0665e-01,  2.2751e-02,  3.6135e-02,
         -1.6912e-02,  4.4335e-02,  1.5793e-01, -1.8534e-02,  1.2559e-01,
         -9.8873e-02,  9.9978e-02, -1.3152e-01, -1.8882e-01, -3.3489e-02,
         -4.1263e-02, -1.1274e-01,  1.6773e-01, -4.3797e-02, -1.2082e-02,
         -8.0753e-03, -4.6151e-02, -7.5679e-02,  9.7387e-02, -1.3518e-01,
         -9.7160e-03,  7.3433e-02, -6.6972e-02, -5.9386e-02,  1.1242e-02,
         -1.3413e-01, -7.7718e-02, -5.5371e-02,  2.4206e-02, -3.3635e-02,
          1.4124e-02, -1.7401e-02,  2.7746e-03, -1.0857e-01, -3.5619e-03,
          1.2234e-01,  8.8695e-02, -1.4942e-01, -4.8687e-02,  2.1523e-02,
         -2.2605e-02,  1.8324e-02, -1.8216e-01, -5.4225e-02, -2.2873e-02,
         -7.9592e-02,  3.2068e-02, -2.7090e-02,  1.4818e-01,  8.6088e-02,
          7.7994e-02,  1.6886e-01,  4.7682e-02, -5.3181e-02, -4.4105e-02,
         -1.3953e-01,  1.4355e-01, -7.0248e-02,  9.7835e-02,  8.4841e-02,
         -5.4589e-03,  2.0638e-02,  2.0780e-02,  1.5013e-01,  2.1464e-01,
          1.1079e-02, -2.0941e-01, -1.3912e-01,  2.0294e-01, -7.7430e-04,
          6.2203e-02, -1.6518e-01, -1.3258e-01, -3.3042e-02,  6.2540e-02,
         -2.1506e-03,  2.6489e-02, -7.8453e-02,  1.1874e-01,  2.1315e-02,
         -1.1911e-01,  9.2924e-02, -5.9299e-02,  9.5401e-02, -1.3164e-02,
         -1.1209e-01, -3.1385e-02, -1.6086e-01,  3.7286e-04,  5.5572e-02,
         -7.6330e-02, -3.7963e-03,  1.3685e-01, -8.0606e-02,  1.1609e-01,
         -1.9588e-02, -8.4574e-02, -7.7919e-02,  2.7531e-02, -3.9202e-02,
         -4.6917e-02, -6.3466e-03,  1.4946e-01,  8.4712e-02,  3.2886e-02,
          1.3623e-01,  3.9058e-02, -9.1492e-02,  8.5212e-03,  7.0252e-02,
          6.0630e-02, -8.5442e-02, -2.7412e-01,  2.4781e-01,  3.4880e-02,
         -9.4958e-03, -1.1962e-01, -1.4453e-01,  4.9316e-02, -1.3579e-01,
          6.3619e-02,  1.0916e-01, -4.5978e-02,  6.4054e-02, -4.4888e-02,
          4.7858e-02, -4.3357e-02,  7.2165e-02,  1.7891e-02, -7.3776e-02,
          1.2521e-02, -4.4145e-02,  3.1869e-03,  1.5954e-02, -1.0397e-02,
          7.8487e-02, -1.4105e-01,  5.5454e-02, -8.8987e-03, -1.7581e-02,
          2.1280e-02, -1.6835e-02,  1.9381e-01, -2.3761e-02,  1.2191e-01,
         -1.4556e-01,  6.0137e-03,  1.1145e-01,  1.0131e-01, -7.7989e-02,
         -1.5294e-01, -3.0603e-02,  1.7089e-02, -1.3923e-01,  1.7573e-01,
         -8.8195e-02, -8.4532e-02,  7.8989e-03,  1.2754e-01, -8.2575e-02,
         -3.0851e-02, -1.8139e-01,  4.7186e-02, -5.2357e-02, -1.4014e-03,
          6.8081e-02]], grad_fn=<MeanBackward1>)}
:Dictionary inputs to traced functions must have consistent type. Found Dict[str, Tensor] and Tensor
2026-01-07 16:30:15,952 - SuccessAgileNIDSTrainer - WARNING - TorchScript export failed (not critical): Tracer cannot infer type of {'classification': {'logits': tensor([[ 4.1215, -4.3217]], grad_fn=<AddmmBackward0>), 'class_probabilities': tensor([[9.9978e-01, 2.1532e-04]], grad_fn=<SoftmaxBackward0>),
2026-01-07 16:30:15,952 - SuccessAgileNIDSTrainer - INFO - Continuing without TorchScript models - using PyTorch state_dict files instead
2026-01-07 16:30:15,953 - EnhancedAgileNIDS - INFO - [SUCCESS] Deployment configuration saved to experiments/enhanced_agile_nids_success_20260107_160856\deployment_config.json
2026-01-07 16:30:15,953 - SuccessAgileNIDSTrainer - INFO - Dual-stream models created
2026-01-07 16:30:15,953 - SuccessAgileNIDSTrainer - INFO - Running performance validation...
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO - Performance validation complete
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   detection_rate: 0.96
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   false_positive_rate: 0.04
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   precision: 0.95
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   recall: 0.93
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   f1_score: 0.94
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   roc_auc: 0.98
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   avg_inference_time_ms: 35.7
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   memory_usage_mb: 148.3
2026-01-07 16:30:15,954 - SuccessAgileNIDSTrainer - INFO -   edge_deployment_score: 0.93
2026-01-07 16:30:15,955 - SuccessAgileNIDSTrainer - INFO - Training report generated
